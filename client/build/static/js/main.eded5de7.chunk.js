(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{21:function(e,t,n){},41:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n(16),c=n.n(r),s=(n(21),n(2)),i=n(4),o=n.n(i),l=n(5),u=n.n(l),d=n(7),j=(n(41),n(0));var b=function(e){var t=Object(a.useState)(void 0),n=Object(s.a)(t,2),r=n[0],c=n[1],i=function(t){t.preventDefault(),null!==e.data?o()({url:"/save",method:"POST",data:{movie:e.movie}}).then((function(e){403!==e.status?console.log(e.data):alert("You need to be logged in to use this feature")})).catch((function(e){return console.log(e)})):alert("You have to be logged in to use this feature")},l=function(t){t.preventDefault(),o()({url:"/remove",method:"POST",data:{movie:e.movie}}).then((function(t){if(403!==t.status){if(e.areFav){var n=e.movies.slice(0,e.rendered),a=e.movies.slice(e.rendered+1);e.setRendered(0>e.rendered-1?0:e.rendered-1),e.setMovies(n.concat(a))}}else console.log("ERROR - Tried to remove from favourites without being logged in")})).catch((function(){return console.log("An error occured")}))};return Object(a.useEffect)((function(){var t;(t=e.movie,o()({url:"/favourites",method:"GET"}).then((function(e){for(var n=0;n<e.data.length;++n)if(a=e.data[n],r=t,JSON.stringify(a)===JSON.stringify(r))return!0;var a,r;return!1})).catch((function(e){return console.log(e)}))).then((function(e){c(e?Object(j.jsx)("form",{onSubmit:l,children:Object(j.jsx)("button",{className:"button",type:"submit",children:"Remove from favourites"})}):Object(j.jsx)("form",{onSubmit:i,children:Object(j.jsx)("button",{className:"button",type:"submit",children:"Add to favourites"})}))}))})),Object(j.jsxs)("div",{className:"card",children:[Object(j.jsx)("img",{className:"card-image",src:"https://image.tmdb.org/t/p/w185_and_h278_bestv2/".concat(e.movie.poster_path),alt:e.movie.title+" poster"}),Object(j.jsxs)("div",{className:"card-content",children:[Object(j.jsx)("h3",{className:"card-title",children:e.movie.title}),Object(j.jsx)("p",{children:Object(j.jsxs)("small",{children:["RELEASE DATE: ",e.movie.release_date]})}),Object(j.jsx)("p",{children:Object(j.jsxs)("small",{children:["RATING: ",e.movie.vote_average]})}),Object(j.jsx)("p",{className:"card-desc",children:e.movie.overview}),r]})]})};n(43);var h=function(e){var t=e.data,n=Object(a.useState)(""),r=Object(s.a)(n,2),c=r[0],i=r[1],l=Object(a.useState)([]),h=Object(s.a)(l,2),v=h[0],m=h[1],f=Object(a.useState)(0),O=Object(s.a)(f,2),p=O[0],x=O[1],g=Object(a.useState)(!1),N=Object(s.a)(g,2),S=N[0],k=N[1];Object(a.useEffect)((function(){var e=function(){var e=Object(d.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://api.themoviedb.org/3/movie/popular?api_key=200341856882729a54726055a4af051e&language=en-US",e.prev=1,e.next=4,fetch("https://api.themoviedb.org/3/movie/popular?api_key=200341856882729a54726055a4af051e&language=en-US");case 4:return t=e.sent,e.next=7,t.json();case 7:n=e.sent,m(n.results),k(!1),x(0),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,13]])})));return function(){return e.apply(this,arguments)}}();0===v.length&&e()}));var w=function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""!==c){e.next=4;break}return alert("No movie name found"),e.abrupt("return");case 4:return n="https://api.themoviedb.org/3/search/movie?api_key=200341856882729a54726055a4af051e&language=en-US&query=".concat(c,"&page=1&include_adult=false"),e.prev=5,e.next=8,fetch(n);case 8:return a=e.sent,e.next=11,a.json();case 11:r=e.sent,m(r.results),i(""),x(0),k(!1),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(5),console.log(e.t0);case 21:case"end":return e.stop()}}),e,null,[[5,18]])})));return function(t){return e.apply(this,arguments)}}(),y=null!==t?Object(j.jsx)("button",{className:"button",onClick:function(){o()({url:"/favourites",method:"GET"}).then((function(e){0===e.data.length?alert("No favourite movies found"):(m(e.data),k(!0),x(0))}))},children:"Show Favourites"}):void 0,E=v.filter((function(e){return e.poster_path})).map((function(e){return Object(j.jsx)(b,{movie:e,areFav:S,movies:v,data:t,rendered:p,setRendered:x,setMovies:m},e.id)})),C=[];return 0!==E.length&&(0!==p&&(C[0]=Object(j.jsx)("button",{className:"button",onClick:function(){return x(p-1)},children:"Back"})),p!==E.length-1&&(C[1]=Object(j.jsx)("button",{className:"button",onClick:function(){return x(p+1)},children:"Next"}))),Object(j.jsxs)("div",{id:"home-content",children:[Object(j.jsxs)("div",{id:"search",children:[Object(j.jsxs)("form",{id:"find-movie",onSubmit:w,children:[Object(j.jsx)("label",{className:"label",htmlFor:"search",children:"Movie Name"}),Object(j.jsx)("input",{className:"input",type:"text",name:"search",placeholder:"Enter movie name",value:c,onChange:function(e){return i(e.target.value)}}),Object(j.jsx)("button",{className:"button",type:"submit",children:"Search!"})]}),y]}),Object(j.jsxs)("div",{id:"movies",children:[E[p],Object(j.jsx)("div",{id:"buttons",children:C})]})]})};n(44);function v(e){var t,n=Object(a.useState)(""),r=Object(s.a)(n,2),c=r[0],i=r[1],l=Object(a.useState)(""),u=Object(s.a)(l,2),d=u[0],b=u[1],h=Object(a.useState)(""),v=Object(s.a)(h,2),m=v[0],f=v[1],O="register"===e.source?Object(j.jsxs)("p",{children:[Object(j.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(j.jsx)("input",{type:"text",name:"username",placeholder:"Enter username",value:c,onChange:function(e){return i(e.target.value)},maxLength:"254",autoFocus:!0,required:!0})]}):void 0;return Object(j.jsxs)("form",{id:e.source,onSubmit:(t=e.source,function(n){n.preventDefault();var a={name:c,email:d,password:m};o()({url:"/".concat(t),method:"POST",data:a}).then((function(n){i(""),b(""),f(""),404===n.status&&alert(n.data),200===n.status&&("login"===t?e.setData(n.data):alert(n.data))})).catch((function(e){alert("Sorry, something went wrong"),console.log(e)}))}),children:[O,Object(j.jsxs)("p",{children:[Object(j.jsx)("label",{htmlFor:"email",children:"Email:"}),Object(j.jsx)("input",{type:"text",name:"email",placeholder:"Enter email",value:d,onChange:function(e){return b(e.target.value)},maxLength:"254",required:!0})]}),Object(j.jsxs)("p",{children:[Object(j.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(j.jsx)("input",{type:"password",name:"password",placeholder:"Enter password",value:m,onChange:function(e){return f(e.target.value)},required:!0})]}),Object(j.jsx)("button",{type:"submit",children:"log in"})]})}var m=function(e){var t=e.data,n=e.setData,r=Object(a.useState)(!1),c=Object(s.a)(r,2),i=c[0],l=c[1],u=Object(a.useState)(!1),d=Object(s.a)(u,2),b=d[0],h=d[1],m=Object(a.useState)(!1),f=Object(s.a)(m,2),O=f[0],p=f[1];console.log(t);var x=function(){l(!i)};if(null!==t)return Object(j.jsxs)("div",{id:"panel",children:[Object(j.jsx)("i",{className:"far fa-user-circle fa-3x"+(i?" active":""),id:"opener",onClick:x}),Object(j.jsxs)("div",{className:i?"active":"",id:"box",children:[Object(j.jsxs)("p",{children:["Hello, ",t.name]}),Object(j.jsx)("div",{className:"wrapper",onClick:function(){o()({url:"/logout",method:"POST"}).then((function(e){403!==e.status?(n(null),alert(e.data)):alert(e.data)}))},children:"Logout"})]})]});var g=function(e,t){return e?Object(j.jsx)(v,{id:t,source:t,setData:n}):void 0};return Object(j.jsxs)("div",{id:"panel",children:[Object(j.jsx)("i",{className:"far fa-user-circle fa-3x"+(i?" active":""),id:"opener",onClick:x}),Object(j.jsxs)("div",{className:i?"active":"",id:"box",children:[Object(j.jsx)("div",{className:"wrapper",onClick:function(){return h(!b)},children:"Login"}),g(b,"login"),Object(j.jsx)("div",{className:"wrapper",onClick:function(){return p(!O)},children:"Register"}),g(O,"register")]})]})};n(45);var f=function(){var e=Object(a.useState)(null),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){o()({url:"/user",method:"GET"}).then((function(e){""!==e.data&&r(e.data)}))}),[]),Object(j.jsxs)("div",{id:"container",children:[Object(j.jsx)("header",{className:"title",id:"mainHeader",children:Object(j.jsx)("h1",{children:"Movie Picker"})}),Object(j.jsx)(m,{id:"userPanel",data:n,setData:r}),Object(j.jsx)(h,{data:n}),Object(j.jsx)("footer",{className:"small",id:"mainFooter",children:"Jakub Korzeniewski \xa9 2021"})]})};c.a.render(Object(j.jsx)("div",{id:"app",children:Object(j.jsx)(f,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.eded5de7.chunk.js.map